


# image registry to use
image:
  registry: ""
  name: ""
  pullPolicy: Always

configuration:
  # servername for this dendrite deployment
  servername:

  # disable registration
  registration_disabled: true

  # matrix signing key path to use
  # needs to be generated before deployment at the moment (TODO)
  #matrix_key:
    
  key_validity_period: 168h0m0s

  # database connection settings
  database:
    host: 
    user: 
    password: 

    max_open_conns: 100
    max_idle_conns: 2
    conn_max_lifetime: -1

  # prometheus metrics
  metrics:
    enabled: true
    basic_auth:
      user: "metrics"
      password: metrics

  # kafka connection settings
  kafka:
    topic_prefix: "Dendrite"
    use_naffka: false
    #use_nats: true
    max_message_bytes: 8388608
    addresses:
      - nats://nats-cluster.nats.svc.cluster.local:4222 #kafka.kafka.svc.cluster.local:9092

  # outbound proxy settings for federation sender
  outbound_proxy:
    enabled: false
    protocol: http
    host: localhost
    port: 8080

  dns_cache:
    enabled: true
    size: 1024
    lifetime: 600

  logging:
    level: trace
    path: /var/log/dendrite

# default resource requests/limits
resources:
  requests:
    cpu: 80m
    memory: 64Mi

  limits:
    cpu: 240m
    memory: 256Mi

# Components to deploy
# listen_int is the port for the internal api connection
# listen_ext is the port to use for external requests
# connect defines the dns and port (should be the same as listen_int) for other services to use for connections

components:
  appservice:
    listen_int: 7777
    connect: appservice:7777

  clientapi:
    listen_int: 7771
    listen_ext: 8071
    connect: clientapi:7771

  eduserver:
    listen_int: 7778
    connect: eduserver:7778

  federationapi:
    listen_int: 7772
    listen_ext: 8072
    connect: federationapi:7772

  federationsender:
    listen_int: 7775
    connect: federationsender:7775

  keyserver:
    listen_int: 7779
    connect: keyserver:7779

  mediaapi:
    listen_int: 7774
    listen_ext: 8074
    connect: mediaapi:7774
    max_file_size_bytes: 10485760

  roomserver:
    listen_int: 7770
    connect: roomserver:7770

  syncapi:
    listen_int: 7773
    listen_ext: 8073
    connect: syncapi:7773

  signingkeyserver:
    listen_int: 7780
    connect: signingkeyserver:7780

  userapi:
    listen_int: 7781
    connect: userapi:7781
